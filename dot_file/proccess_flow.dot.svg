<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.34.0 (20130907.0111)
 -->
<!-- Title: G Pages: 1 -->
<svg width="560pt" height="1707pt"
 viewBox="0.00 0.00 560.00 1707.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1703)">
<title>G</title>
<polygon fill="white" stroke="white" points="-4,4 -4,-1703 556,-1703 556,4 -4,4"/>
<text text-anchor="middle" x="276" y="-22.8" font-family="FangSong" font-size="14.00">drive的主要过程 </text>
<text text-anchor="middle" x="276" y="-7.8" font-family="FangSong" font-size="14.00"> Driver.runInternal() 方法中</text>
<g id="clust1" class="cluster"><title>cluster_total</title>
<polygon fill="none" stroke="black" points="8,-46 8,-1691 544,-1691 544,-46 8,-46"/>
<text text-anchor="middle" x="276" y="-1675.8" font-family="FangSong" font-size="14.00">drive的主要过程 </text>
<text text-anchor="middle" x="276" y="-1660.8" font-family="FangSong" font-size="14.00"> Driver.runInternal() 方法中</text>
</g>
<g id="clust2" class="cluster"><title>cluster_a</title>
<polygon fill="none" stroke="black" points="16,-722 16,-1531 536,-1531 536,-722 16,-722"/>
<text text-anchor="middle" x="276" y="-1515.8" font-family="FangSong" font-size="14.00">编译过程 </text>
<text text-anchor="middle" x="276" y="-1500.8" font-family="FangSong" font-size="14.00"> Driver.compile() 方法中 主要是词法和语法解析 </text>
<text text-anchor="middle" x="276" y="-1485.8" font-family="FangSong" font-size="14.00"> 以及语义分析和生成并优化执行计划</text>
</g>
<g id="clust3" class="cluster"><title>cluster_aa1</title>
<polygon fill="none" stroke="blue" points="137,-1304 137,-1470 439,-1470 439,-1304 137,-1304"/>
<text text-anchor="middle" x="288" y="-1454.8" font-family="FangSong" font-size="14.00">语法分析 </text>
<text text-anchor="middle" x="288" y="-1439.8" font-family="FangSong" font-size="14.00"> ParseDriver.Parse() 中完成</text>
</g>
<g id="clust4" class="cluster"><title>cluster_aa2</title>
<polygon fill="none" stroke="blue" points="24,-730 24,-1266 528,-1266 528,-730 24,-730"/>
<text text-anchor="middle" x="276" y="-1250.8" font-family="FangSong" font-size="14.00">语义分析</text>
<text text-anchor="middle" x="276" y="-1235.8" font-family="FangSong" font-size="14.00">BaseSemanticAnalyzer.Analyze()&#45;&gt;具体子类中的analyzeInternal()方法</text>
</g>
<g id="clust5" class="cluster"><title>cluster_b</title>
<polygon fill="none" stroke="blue" points="111,-158 111,-692 441,-692 441,-158 111,-158"/>
<text text-anchor="middle" x="276" y="-676.8" font-family="FangSong" font-size="14.00">执行过程</text>
<text text-anchor="middle" x="276" y="-661.8" font-family="FangSong" font-size="14.00">Driver.execute方法</text>
</g>
<!-- predriverrun -->
<g id="node1" class="node"><title>predriverrun</title>
<polygon fill="lightgrey" stroke="black" points="510,-1645 66,-1645 66,-1577 510,-1577 510,-1645"/>
<text text-anchor="middle" x="288" y="-1629.8" font-family="FangSong" font-size="14.00"> 任务执行时的钩子中的执行前方法 </text>
<text text-anchor="middle" x="288" y="-1614.8" font-family="FangSong" font-size="14.00"> hive.exec.driver.run.hooks 配置的hook的preDriverRun方法 </text>
<text text-anchor="middle" x="288" y="-1599.8" font-family="FangSong" font-size="14.00"> 很奇怪的方式 后面钩子都是执行前后分开的独立类 </text>
<text text-anchor="middle" x="288" y="-1584.8" font-family="FangSong" font-size="14.00"> 这里却只是同一个类的独立方法</text>
</g>
<!-- lexer -->
<g id="node2" class="node"><title>lexer</title>
<polygon fill="lightgrey" stroke="black" points="431,-1424 145,-1424 145,-1386 431,-1386 431,-1424"/>
<text text-anchor="middle" x="288" y="-1408.8" font-family="FangSong" font-size="14.00"> 词法解析 </text>
<text text-anchor="middle" x="288" y="-1393.8" font-family="FangSong" font-size="14.00"> HiveLexerX 一个经过包装的词法解析器</text>
</g>
<!-- predriverrun&#45;&gt;lexer -->
<g id="edge15" class="edge"><title>predriverrun&#45;&gt;lexer</title>
<path fill="none" stroke="black" d="M288,-1576.77C288,-1566.28 288,-1553.96 288,-1540.84"/>
<polygon fill="black" stroke="black" points="291.5,-1540.66 288,-1530.66 284.5,-1540.66 291.5,-1540.66"/>
</g>
<!-- parser -->
<g id="node3" class="node"><title>parser</title>
<polygon fill="lightgrey" stroke="black" points="420,-1350 156,-1350 156,-1312 420,-1312 420,-1350"/>
<text text-anchor="middle" x="288" y="-1334.8" font-family="FangSong" font-size="14.00">语法解析并生成抽象语法树 </text>
<text text-anchor="middle" x="288" y="-1319.8" font-family="FangSong" font-size="14.00"> HiveParser 纯粹的语法解析与转换 </text>
</g>
<!-- lexer&#45;&gt;parser -->
<g id="edge1" class="edge"><title>lexer&#45;&gt;parser</title>
<path fill="none" stroke="black" d="M288,-1385.83C288,-1378.13 288,-1368.97 288,-1360.42"/>
<polygon fill="black" stroke="black" points="291.5,-1360.41 288,-1350.41 284.5,-1360.41 291.5,-1360.41"/>
</g>
<!-- ppa -->
<g id="node4" class="node"><title>ppa</title>
<polygon fill="lightgrey" stroke="black" points="371.25,-1220 204.75,-1220 204.75,-1182 371.25,-1182 371.25,-1220"/>
<text text-anchor="middle" x="288" y="-1204.8" font-family="FangSong" font-size="14.00">processPositionAlias</text>
<text text-anchor="middle" x="288" y="-1189.8" font-family="FangSong" font-size="14.00">处理位置别名</text>
</g>
<!-- parser&#45;&gt;ppa -->
<g id="edge16" class="edge"><title>parser&#45;&gt;ppa</title>
<path fill="none" stroke="black" d="M288,-1304.11C288,-1295.79 288,-1286.13 288,-1276.13"/>
<polygon fill="black" stroke="black" points="291.5,-1275.86 288,-1265.86 284.5,-1275.86 291.5,-1275.86"/>
</g>
<!-- actc -->
<g id="node5" class="node"><title>actc</title>
<polygon fill="lightgrey" stroke="black" points="401.25,-1146 174.75,-1146 174.75,-1108 401.25,-1108 401.25,-1146"/>
<text text-anchor="middle" x="288" y="-1130.8" font-family="FangSong" font-size="14.00">analyze create table command</text>
<text text-anchor="middle" x="288" y="-1115.8" font-family="FangSong" font-size="14.00">分析创建表格命令</text>
</g>
<!-- ppa&#45;&gt;actc -->
<g id="edge2" class="edge"><title>ppa&#45;&gt;actc</title>
<path fill="none" stroke="black" d="M288,-1181.83C288,-1174.13 288,-1164.97 288,-1156.42"/>
<polygon fill="black" stroke="black" points="291.5,-1156.41 288,-1146.41 284.5,-1156.41 291.5,-1156.41"/>
</g>
<!-- acvc -->
<g id="node6" class="node"><title>acvc</title>
<polygon fill="lightgrey" stroke="black" points="401.25,-1072 174.75,-1072 174.75,-1034 401.25,-1034 401.25,-1072"/>
<text text-anchor="middle" x="288" y="-1056.8" font-family="FangSong" font-size="14.00">analyze create table command</text>
<text text-anchor="middle" x="288" y="-1041.8" font-family="FangSong" font-size="14.00">分析创建表格命令</text>
</g>
<!-- actc&#45;&gt;acvc -->
<g id="edge3" class="edge"><title>actc&#45;&gt;acvc</title>
<path fill="none" stroke="black" d="M288,-1107.83C288,-1100.13 288,-1090.97 288,-1082.42"/>
<polygon fill="black" stroke="black" points="291.5,-1082.41 288,-1072.41 284.5,-1082.41 291.5,-1082.41"/>
</g>
<!-- phase1 -->
<g id="node7" class="node"><title>phase1</title>
<polygon fill="lightgrey" stroke="black" points="341,-998 235,-998 235,-960 341,-960 341,-998"/>
<text text-anchor="middle" x="288" y="-982.8" font-family="FangSong" font-size="14.00">dophase1</text>
<text text-anchor="middle" x="288" y="-967.8" font-family="FangSong" font-size="14.00">第一阶段分析</text>
</g>
<!-- acvc&#45;&gt;phase1 -->
<g id="edge4" class="edge"><title>acvc&#45;&gt;phase1</title>
<path fill="none" stroke="black" d="M288,-1033.83C288,-1026.13 288,-1016.97 288,-1008.42"/>
<polygon fill="black" stroke="black" points="291.5,-1008.41 288,-998.413 284.5,-1008.41 291.5,-1008.41"/>
</g>
<!-- genplan -->
<g id="node8" class="node"><title>genplan</title>
<polygon fill="lightgrey" stroke="black" points="341,-924 235,-924 235,-886 341,-886 341,-924"/>
<text text-anchor="middle" x="288" y="-908.8" font-family="FangSong" font-size="14.00">genplan</text>
<text text-anchor="middle" x="288" y="-893.8" font-family="FangSong" font-size="14.00">产生执行计划</text>
</g>
<!-- phase1&#45;&gt;genplan -->
<g id="edge5" class="edge"><title>phase1&#45;&gt;genplan</title>
<path fill="none" stroke="black" d="M288,-959.831C288,-952.131 288,-942.974 288,-934.417"/>
<polygon fill="black" stroke="black" points="291.5,-934.413 288,-924.413 284.5,-934.413 291.5,-934.413"/>
</g>
<!-- optimizer -->
<g id="node9" class="node"><title>optimizer</title>
<polygon fill="lightgrey" stroke="black" points="401,-850 175,-850 175,-812 401,-812 401,-850"/>
<text text-anchor="middle" x="288" y="-834.8" font-family="FangSong" font-size="14.00">optimizer</text>
<text text-anchor="middle" x="288" y="-819.8" font-family="FangSong" font-size="14.00">根据选项设置的优化器进行优化</text>
</g>
<!-- genplan&#45;&gt;optimizer -->
<g id="edge6" class="edge"><title>genplan&#45;&gt;optimizer</title>
<path fill="none" stroke="black" d="M288,-885.831C288,-878.131 288,-868.974 288,-860.417"/>
<polygon fill="black" stroke="black" points="291.5,-860.413 288,-850.413 284.5,-860.413 291.5,-860.413"/>
</g>
<!-- mapreducecompiler -->
<g id="node10" class="node"><title>mapreducecompiler</title>
<polygon fill="lightgrey" stroke="black" points="360,-776 216,-776 216,-738 360,-738 360,-776"/>
<text text-anchor="middle" x="288" y="-760.8" font-family="FangSong" font-size="14.00">mapreducecompiler</text>
<text text-anchor="middle" x="288" y="-745.8" font-family="FangSong" font-size="14.00">产生mr执行计划</text>
</g>
<!-- optimizer&#45;&gt;mapreducecompiler -->
<g id="edge7" class="edge"><title>optimizer&#45;&gt;mapreducecompiler</title>
<path fill="none" stroke="black" d="M288,-811.831C288,-804.131 288,-794.974 288,-786.417"/>
<polygon fill="black" stroke="black" points="291.5,-786.413 288,-776.413 284.5,-786.413 291.5,-786.413"/>
</g>
<!-- prehook -->
<g id="node11" class="node"><title>prehook</title>
<polygon fill="lightgrey" stroke="black" points="427.25,-646 148.75,-646 148.75,-608 427.25,-608 427.25,-646"/>
<text text-anchor="middle" x="288" y="-630.8" font-family="FangSong" font-size="14.00">执行前的钩子</text>
<text text-anchor="middle" x="288" y="-615.8" font-family="FangSong" font-size="14.00">配置文件中的hive.exec.pre.hooks配置</text>
</g>
<!-- mapreducecompiler&#45;&gt;prehook -->
<g id="edge17" class="edge"><title>mapreducecompiler&#45;&gt;prehook</title>
<path fill="none" stroke="black" d="M288,-722.232C288,-715.927 288,-709.112 288,-702.133"/>
<polygon fill="black" stroke="black" points="291.5,-701.86 288,-691.86 284.5,-701.86 291.5,-701.86"/>
</g>
<!-- launchtask -->
<g id="node12" class="node"><title>launchtask</title>
<polygon fill="lightgrey" stroke="black" points="401,-572 175,-572 175,-534 401,-534 401,-572"/>
<text text-anchor="middle" x="288" y="-556.8" font-family="FangSong" font-size="14.00">从可执行任务队列中取任务执行</text>
<text text-anchor="middle" x="288" y="-541.8" font-family="FangSong" font-size="14.00">launchTask方法</text>
</g>
<!-- prehook&#45;&gt;launchtask -->
<g id="edge8" class="edge"><title>prehook&#45;&gt;launchtask</title>
<path fill="none" stroke="black" d="M288,-607.831C288,-600.131 288,-590.974 288,-582.417"/>
<polygon fill="black" stroke="black" points="291.5,-582.413 288,-572.413 284.5,-582.413 291.5,-582.413"/>
</g>
<!-- polltasks -->
<g id="node13" class="node"><title>polltasks</title>
<polygon fill="lightgrey" stroke="black" points="350.25,-498 199.75,-498 199.75,-460 350.25,-460 350.25,-498"/>
<text text-anchor="middle" x="275" y="-482.8" font-family="FangSong" font-size="14.00">检查执行完成的任务</text>
<text text-anchor="middle" x="275" y="-467.8" font-family="FangSong" font-size="14.00">pollTasks方法</text>
</g>
<!-- launchtask&#45;&gt;polltasks -->
<g id="edge9" class="edge"><title>launchtask&#45;&gt;polltasks</title>
<path fill="none" stroke="black" d="M284.72,-533.831C283.329,-526.131 281.676,-516.974 280.131,-508.417"/>
<polygon fill="black" stroke="black" points="283.546,-507.632 278.325,-498.413 276.657,-508.876 283.546,-507.632"/>
</g>
<!-- backtasks -->
<g id="node14" class="node"><title>backtasks</title>
<polygon fill="lightgrey" stroke="black" points="411,-424 125,-424 125,-388 411,-388 411,-424"/>
<text text-anchor="middle" x="268" y="-402.3" font-family="FangSong" font-size="14.00">判断是否将备份任务加入可执行任务队列</text>
</g>
<!-- polltasks&#45;&gt;backtasks -->
<g id="edge10" class="edge"><title>polltasks&#45;&gt;backtasks</title>
<path fill="none" stroke="black" d="M273.197,-459.716C272.426,-451.887 271.508,-442.585 270.661,-433.99"/>
<polygon fill="black" stroke="black" points="274.141,-433.612 269.676,-424.003 267.175,-434.299 274.141,-433.612"/>
</g>
<!-- failurehook -->
<g id="node15" class="node"><title>failurehook</title>
<polygon fill="lightgrey" stroke="black" points="413,-352 119,-352 119,-314 413,-314 413,-352"/>
<text text-anchor="middle" x="266" y="-336.8" font-family="FangSong" font-size="14.00">任务失败时执行失败钩子</text>
<text text-anchor="middle" x="266" y="-321.8" font-family="FangSong" font-size="14.00">配置文件中hive.exec.failure.hooks配置</text>
</g>
<!-- backtasks&#45;&gt;failurehook -->
<g id="edge11" class="edge"><title>backtasks&#45;&gt;failurehook</title>
<path fill="none" stroke="black" d="M267.516,-387.813C267.299,-380.11 267.037,-370.823 266.793,-362.149"/>
<polygon fill="black" stroke="black" points="270.288,-361.917 266.508,-352.02 263.291,-362.114 270.288,-361.917"/>
</g>
<!-- addchildtask -->
<g id="node16" class="node"><title>addchildtask</title>
<polygon fill="lightgrey" stroke="black" points="423,-278 129,-278 129,-240 423,-240 423,-278"/>
<text text-anchor="middle" x="276" y="-262.8" font-family="FangSong" font-size="14.00">添加子任务到可执行任务队列</text>
<text text-anchor="middle" x="276" y="-247.8" font-family="FangSong" font-size="14.00">配置文件中hive.exec.failure.hooks配置</text>
</g>
<!-- failurehook&#45;&gt;addchildtask -->
<g id="edge12" class="edge"><title>failurehook&#45;&gt;addchildtask</title>
<path fill="none" stroke="black" d="M268.523,-313.831C269.593,-306.131 270.865,-296.974 272.053,-288.417"/>
<polygon fill="black" stroke="black" points="275.534,-288.8 273.443,-278.413 268.6,-287.837 275.534,-288.8"/>
</g>
<!-- addchildtask&#45;&gt;launchtask -->
<g id="edge14" class="edge"><title>addchildtask&#45;&gt;launchtask</title>
<path fill="none" stroke="black" d="M374.752,-278.026C393.321,-285.998 410.495,-297.477 422,-314 449.942,-354.127 437.16,-378.213 420,-424 402.98,-469.412 359.673,-506.004 327.273,-528.251"/>
<polygon fill="black" stroke="black" points="325.241,-525.399 318.875,-533.868 329.133,-531.218 325.241,-525.399"/>
</g>
<!-- posthook -->
<g id="node17" class="node"><title>posthook</title>
<polygon fill="lightgrey" stroke="black" points="411.25,-204 140.75,-204 140.75,-166 411.25,-166 411.25,-204"/>
<text text-anchor="middle" x="276" y="-188.8" font-family="FangSong" font-size="14.00">执行后钩子</text>
<text text-anchor="middle" x="276" y="-173.8" font-family="FangSong" font-size="14.00">配置文件中hive.exec.post.hooks配置</text>
</g>
<!-- addchildtask&#45;&gt;posthook -->
<g id="edge13" class="edge"><title>addchildtask&#45;&gt;posthook</title>
<path fill="none" stroke="black" d="M276,-239.831C276,-232.131 276,-222.974 276,-214.417"/>
<polygon fill="black" stroke="black" points="279.5,-214.413 276,-204.413 272.5,-214.413 279.5,-214.413"/>
</g>
<!-- postdriverrun -->
<g id="node18" class="node"><title>postdriverrun</title>
<polygon fill="lightgrey" stroke="black" points="501.25,-92 50.75,-92 50.75,-54 501.25,-54 501.25,-92"/>
<text text-anchor="middle" x="276" y="-76.8" font-family="FangSong" font-size="14.00"> 任务执行时的钩子中的执行后方法 </text>
<text text-anchor="middle" x="276" y="-61.8" font-family="FangSong" font-size="14.00"> hive.exec.driver.run.hooks 配置的hook的postDriverRun方法 </text>
</g>
<!-- posthook&#45;&gt;postdriverrun -->
<g id="edge18" class="edge"><title>posthook&#45;&gt;postdriverrun</title>
<path fill="none" stroke="black" d="M276,-158.057C276,-141.3 276,-119.494 276,-102.292"/>
<polygon fill="black" stroke="black" points="279.5,-102.191 276,-92.1912 272.5,-102.191 279.5,-102.191"/>
</g>
</g>
</svg>
