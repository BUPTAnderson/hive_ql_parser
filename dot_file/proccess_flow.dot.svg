<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.34.0 (20130907.0111)
 -->
<!-- Title: G Pages: 1 -->
<svg width="560pt" height="1669pt"
 viewBox="0.00 0.00 560.00 1669.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1665)">
<title>G</title>
<polygon fill="white" stroke="white" points="-4,4 -4,-1665 556,-1665 556,4 -4,4"/>
<g id="clust1" class="cluster"><title>cluster_total</title>
<polygon fill="none" stroke="black" points="8,-8 8,-1653 544,-1653 544,-8 8,-8"/>
<text text-anchor="middle" x="276" y="-1637.8" font-family="FangSong" font-size="14.00">drive的主要过程 </text>
<text text-anchor="middle" x="276" y="-1622.8" font-family="FangSong" font-size="14.00"> Driver.runInternal() 方法中</text>
</g>
<g id="clust5" class="cluster"><title>cluster_b</title>
<polygon fill="none" stroke="blue" points="111,-120 111,-654 441,-654 441,-120 111,-120"/>
<text text-anchor="middle" x="276" y="-638.8" font-family="FangSong" font-size="14.00">执行过程</text>
<text text-anchor="middle" x="276" y="-623.8" font-family="FangSong" font-size="14.00">Driver.execute方法</text>
</g>
<g id="clust2" class="cluster"><title>cluster_a</title>
<polygon fill="none" stroke="black" points="16,-684 16,-1493 536,-1493 536,-684 16,-684"/>
<text text-anchor="middle" x="276" y="-1477.8" font-family="FangSong" font-size="14.00">编译过程 </text>
<text text-anchor="middle" x="276" y="-1462.8" font-family="FangSong" font-size="14.00"> Driver.compile() 方法中 主要是词法和语法解析 </text>
<text text-anchor="middle" x="276" y="-1447.8" font-family="FangSong" font-size="14.00"> 以及语义分析和生成并优化执行计划</text>
</g>
<g id="clust4" class="cluster"><title>cluster_aa2</title>
<polygon fill="none" stroke="blue" points="24,-692 24,-1228 528,-1228 528,-692 24,-692"/>
<text text-anchor="middle" x="276" y="-1212.8" font-family="FangSong" font-size="14.00">语义分析</text>
<text text-anchor="middle" x="276" y="-1197.8" font-family="FangSong" font-size="14.00">BaseSemanticAnalyzer.Analyze()&#45;&gt;具体子类中的analyzeInternal()方法</text>
</g>
<g id="clust3" class="cluster"><title>cluster_aa1</title>
<polygon fill="none" stroke="blue" points="137,-1266 137,-1432 439,-1432 439,-1266 137,-1266"/>
<text text-anchor="middle" x="288" y="-1416.8" font-family="FangSong" font-size="14.00">语法分析 </text>
<text text-anchor="middle" x="288" y="-1401.8" font-family="FangSong" font-size="14.00"> ParseDriver.Parse() 中完成</text>
</g>
<!-- predriverrun -->
<g id="node1" class="node"><title>predriverrun</title>
<polygon fill="lightgrey" stroke="black" points="510,-1607 66,-1607 66,-1539 510,-1539 510,-1607"/>
<text text-anchor="middle" x="288" y="-1591.8" font-family="FangSong" font-size="14.00"> 任务执行时的钩子中的执行前方法 </text>
<text text-anchor="middle" x="288" y="-1576.8" font-family="FangSong" font-size="14.00"> hive.exec.driver.run.hooks 配置的hook的preDriverRun方法 </text>
<text text-anchor="middle" x="288" y="-1561.8" font-family="FangSong" font-size="14.00"> 很奇怪的方式 后面钩子都是执行前后分开的独立类 </text>
<text text-anchor="middle" x="288" y="-1546.8" font-family="FangSong" font-size="14.00"> 这里却只是同一个类的独立方法</text>
</g>
<!-- lexer -->
<g id="node2" class="node"><title>lexer</title>
<polygon fill="lightgrey" stroke="black" points="431,-1386 145,-1386 145,-1348 431,-1348 431,-1386"/>
<text text-anchor="middle" x="288" y="-1370.8" font-family="FangSong" font-size="14.00"> 词法解析 </text>
<text text-anchor="middle" x="288" y="-1355.8" font-family="FangSong" font-size="14.00"> HiveLexerX 一个经过包装的词法解析器</text>
</g>
<!-- predriverrun&#45;&gt;lexer -->
<g id="edge15" class="edge"><title>predriverrun&#45;&gt;lexer</title>
<path fill="none" stroke="black" d="M288,-1538.77C288,-1528.28 288,-1515.96 288,-1502.84"/>
<polygon fill="black" stroke="black" points="291.5,-1502.66 288,-1492.66 284.5,-1502.66 291.5,-1502.66"/>
</g>
<!-- parser -->
<g id="node3" class="node"><title>parser</title>
<polygon fill="lightgrey" stroke="black" points="420,-1312 156,-1312 156,-1274 420,-1274 420,-1312"/>
<text text-anchor="middle" x="288" y="-1296.8" font-family="FangSong" font-size="14.00">语法解析并生成抽象语法树 </text>
<text text-anchor="middle" x="288" y="-1281.8" font-family="FangSong" font-size="14.00"> HiveParser 纯粹的语法解析与转换 </text>
</g>
<!-- lexer&#45;&gt;parser -->
<g id="edge1" class="edge"><title>lexer&#45;&gt;parser</title>
<path fill="none" stroke="black" d="M288,-1347.83C288,-1340.13 288,-1330.97 288,-1322.42"/>
<polygon fill="black" stroke="black" points="291.5,-1322.41 288,-1312.41 284.5,-1322.41 291.5,-1322.41"/>
</g>
<!-- ppa -->
<g id="node4" class="node"><title>ppa</title>
<polygon fill="lightgrey" stroke="black" points="371.25,-1182 204.75,-1182 204.75,-1144 371.25,-1144 371.25,-1182"/>
<text text-anchor="middle" x="288" y="-1166.8" font-family="FangSong" font-size="14.00">processPositionAlias</text>
<text text-anchor="middle" x="288" y="-1151.8" font-family="FangSong" font-size="14.00">处理位置别名</text>
</g>
<!-- parser&#45;&gt;ppa -->
<g id="edge16" class="edge"><title>parser&#45;&gt;ppa</title>
<path fill="none" stroke="black" d="M288,-1266.11C288,-1257.79 288,-1248.13 288,-1238.13"/>
<polygon fill="black" stroke="black" points="291.5,-1237.86 288,-1227.86 284.5,-1237.86 291.5,-1237.86"/>
</g>
<!-- actc -->
<g id="node5" class="node"><title>actc</title>
<polygon fill="lightgrey" stroke="black" points="401.25,-1108 174.75,-1108 174.75,-1070 401.25,-1070 401.25,-1108"/>
<text text-anchor="middle" x="288" y="-1092.8" font-family="FangSong" font-size="14.00">analyze create table command</text>
<text text-anchor="middle" x="288" y="-1077.8" font-family="FangSong" font-size="14.00">分析创建表格命令</text>
</g>
<!-- ppa&#45;&gt;actc -->
<g id="edge2" class="edge"><title>ppa&#45;&gt;actc</title>
<path fill="none" stroke="black" d="M288,-1143.83C288,-1136.13 288,-1126.97 288,-1118.42"/>
<polygon fill="black" stroke="black" points="291.5,-1118.41 288,-1108.41 284.5,-1118.41 291.5,-1118.41"/>
</g>
<!-- acvc -->
<g id="node6" class="node"><title>acvc</title>
<polygon fill="lightgrey" stroke="black" points="401.25,-1034 174.75,-1034 174.75,-996 401.25,-996 401.25,-1034"/>
<text text-anchor="middle" x="288" y="-1018.8" font-family="FangSong" font-size="14.00">analyze create table command</text>
<text text-anchor="middle" x="288" y="-1003.8" font-family="FangSong" font-size="14.00">分析创建表格命令</text>
</g>
<!-- actc&#45;&gt;acvc -->
<g id="edge3" class="edge"><title>actc&#45;&gt;acvc</title>
<path fill="none" stroke="black" d="M288,-1069.83C288,-1062.13 288,-1052.97 288,-1044.42"/>
<polygon fill="black" stroke="black" points="291.5,-1044.41 288,-1034.41 284.5,-1044.41 291.5,-1044.41"/>
</g>
<!-- phase1 -->
<g id="node7" class="node"><title>phase1</title>
<polygon fill="lightgrey" stroke="black" points="341,-960 235,-960 235,-922 341,-922 341,-960"/>
<text text-anchor="middle" x="288" y="-944.8" font-family="FangSong" font-size="14.00">dophase1</text>
<text text-anchor="middle" x="288" y="-929.8" font-family="FangSong" font-size="14.00">第一阶段分析</text>
</g>
<!-- acvc&#45;&gt;phase1 -->
<g id="edge4" class="edge"><title>acvc&#45;&gt;phase1</title>
<path fill="none" stroke="black" d="M288,-995.831C288,-988.131 288,-978.974 288,-970.417"/>
<polygon fill="black" stroke="black" points="291.5,-970.413 288,-960.413 284.5,-970.413 291.5,-970.413"/>
</g>
<!-- genplan -->
<g id="node8" class="node"><title>genplan</title>
<polygon fill="lightgrey" stroke="black" points="341,-886 235,-886 235,-848 341,-848 341,-886"/>
<text text-anchor="middle" x="288" y="-870.8" font-family="FangSong" font-size="14.00">genplan</text>
<text text-anchor="middle" x="288" y="-855.8" font-family="FangSong" font-size="14.00">产生执行计划</text>
</g>
<!-- phase1&#45;&gt;genplan -->
<g id="edge5" class="edge"><title>phase1&#45;&gt;genplan</title>
<path fill="none" stroke="black" d="M288,-921.831C288,-914.131 288,-904.974 288,-896.417"/>
<polygon fill="black" stroke="black" points="291.5,-896.413 288,-886.413 284.5,-896.413 291.5,-896.413"/>
</g>
<!-- optimizer -->
<g id="node9" class="node"><title>optimizer</title>
<polygon fill="lightgrey" stroke="black" points="401,-812 175,-812 175,-774 401,-774 401,-812"/>
<text text-anchor="middle" x="288" y="-796.8" font-family="FangSong" font-size="14.00">optimizer</text>
<text text-anchor="middle" x="288" y="-781.8" font-family="FangSong" font-size="14.00">根据选项设置的优化器进行优化</text>
</g>
<!-- genplan&#45;&gt;optimizer -->
<g id="edge6" class="edge"><title>genplan&#45;&gt;optimizer</title>
<path fill="none" stroke="black" d="M288,-847.831C288,-840.131 288,-830.974 288,-822.417"/>
<polygon fill="black" stroke="black" points="291.5,-822.413 288,-812.413 284.5,-822.413 291.5,-822.413"/>
</g>
<!-- mapreducecompiler -->
<g id="node10" class="node"><title>mapreducecompiler</title>
<polygon fill="lightgrey" stroke="black" points="360,-738 216,-738 216,-700 360,-700 360,-738"/>
<text text-anchor="middle" x="288" y="-722.8" font-family="FangSong" font-size="14.00">mapreducecompiler</text>
<text text-anchor="middle" x="288" y="-707.8" font-family="FangSong" font-size="14.00">产生mr执行计划</text>
</g>
<!-- optimizer&#45;&gt;mapreducecompiler -->
<g id="edge7" class="edge"><title>optimizer&#45;&gt;mapreducecompiler</title>
<path fill="none" stroke="black" d="M288,-773.831C288,-766.131 288,-756.974 288,-748.417"/>
<polygon fill="black" stroke="black" points="291.5,-748.413 288,-738.413 284.5,-748.413 291.5,-748.413"/>
</g>
<!-- prehook -->
<g id="node11" class="node"><title>prehook</title>
<polygon fill="lightgrey" stroke="black" points="427.25,-608 148.75,-608 148.75,-570 427.25,-570 427.25,-608"/>
<text text-anchor="middle" x="288" y="-592.8" font-family="FangSong" font-size="14.00">执行前的钩子</text>
<text text-anchor="middle" x="288" y="-577.8" font-family="FangSong" font-size="14.00">配置文件中的hive.exec.pre.hooks配置</text>
</g>
<!-- mapreducecompiler&#45;&gt;prehook -->
<g id="edge17" class="edge"><title>mapreducecompiler&#45;&gt;prehook</title>
<path fill="none" stroke="black" d="M288,-684.232C288,-677.927 288,-671.112 288,-664.133"/>
<polygon fill="black" stroke="black" points="291.5,-663.86 288,-653.86 284.5,-663.86 291.5,-663.86"/>
</g>
<!-- launchtask -->
<g id="node12" class="node"><title>launchtask</title>
<polygon fill="lightgrey" stroke="black" points="401,-534 175,-534 175,-496 401,-496 401,-534"/>
<text text-anchor="middle" x="288" y="-518.8" font-family="FangSong" font-size="14.00">从可执行任务队列中取任务执行</text>
<text text-anchor="middle" x="288" y="-503.8" font-family="FangSong" font-size="14.00">launchTask方法</text>
</g>
<!-- prehook&#45;&gt;launchtask -->
<g id="edge8" class="edge"><title>prehook&#45;&gt;launchtask</title>
<path fill="none" stroke="black" d="M288,-569.831C288,-562.131 288,-552.974 288,-544.417"/>
<polygon fill="black" stroke="black" points="291.5,-544.413 288,-534.413 284.5,-544.413 291.5,-544.413"/>
</g>
<!-- polltasks -->
<g id="node13" class="node"><title>polltasks</title>
<polygon fill="lightgrey" stroke="black" points="350.25,-460 199.75,-460 199.75,-422 350.25,-422 350.25,-460"/>
<text text-anchor="middle" x="275" y="-444.8" font-family="FangSong" font-size="14.00">检查执行完成的任务</text>
<text text-anchor="middle" x="275" y="-429.8" font-family="FangSong" font-size="14.00">pollTasks方法</text>
</g>
<!-- launchtask&#45;&gt;polltasks -->
<g id="edge9" class="edge"><title>launchtask&#45;&gt;polltasks</title>
<path fill="none" stroke="black" d="M284.72,-495.831C283.329,-488.131 281.676,-478.974 280.131,-470.417"/>
<polygon fill="black" stroke="black" points="283.546,-469.632 278.325,-460.413 276.657,-470.876 283.546,-469.632"/>
</g>
<!-- backtasks -->
<g id="node14" class="node"><title>backtasks</title>
<polygon fill="lightgrey" stroke="black" points="411,-386 125,-386 125,-350 411,-350 411,-386"/>
<text text-anchor="middle" x="268" y="-364.3" font-family="FangSong" font-size="14.00">判断是否将备份任务加入可执行任务队列</text>
</g>
<!-- polltasks&#45;&gt;backtasks -->
<g id="edge10" class="edge"><title>polltasks&#45;&gt;backtasks</title>
<path fill="none" stroke="black" d="M273.197,-421.716C272.426,-413.887 271.508,-404.585 270.661,-395.99"/>
<polygon fill="black" stroke="black" points="274.141,-395.612 269.676,-386.003 267.175,-396.299 274.141,-395.612"/>
</g>
<!-- failurehook -->
<g id="node15" class="node"><title>failurehook</title>
<polygon fill="lightgrey" stroke="black" points="413,-314 119,-314 119,-276 413,-276 413,-314"/>
<text text-anchor="middle" x="266" y="-298.8" font-family="FangSong" font-size="14.00">任务失败时执行失败钩子</text>
<text text-anchor="middle" x="266" y="-283.8" font-family="FangSong" font-size="14.00">配置文件中hive.exec.failure.hooks配置</text>
</g>
<!-- backtasks&#45;&gt;failurehook -->
<g id="edge11" class="edge"><title>backtasks&#45;&gt;failurehook</title>
<path fill="none" stroke="black" d="M267.516,-349.813C267.299,-342.11 267.037,-332.823 266.793,-324.149"/>
<polygon fill="black" stroke="black" points="270.288,-323.917 266.508,-314.02 263.291,-324.114 270.288,-323.917"/>
</g>
<!-- addchildtask -->
<g id="node16" class="node"><title>addchildtask</title>
<polygon fill="lightgrey" stroke="black" points="423,-240 129,-240 129,-202 423,-202 423,-240"/>
<text text-anchor="middle" x="276" y="-224.8" font-family="FangSong" font-size="14.00">添加子任务到可执行任务队列</text>
<text text-anchor="middle" x="276" y="-209.8" font-family="FangSong" font-size="14.00">配置文件中hive.exec.failure.hooks配置</text>
</g>
<!-- failurehook&#45;&gt;addchildtask -->
<g id="edge12" class="edge"><title>failurehook&#45;&gt;addchildtask</title>
<path fill="none" stroke="black" d="M268.523,-275.831C269.593,-268.131 270.865,-258.974 272.053,-250.417"/>
<polygon fill="black" stroke="black" points="275.534,-250.8 273.443,-240.413 268.6,-249.837 275.534,-250.8"/>
</g>
<!-- addchildtask&#45;&gt;launchtask -->
<g id="edge14" class="edge"><title>addchildtask&#45;&gt;launchtask</title>
<path fill="none" stroke="black" d="M374.752,-240.026C393.321,-247.998 410.495,-259.477 422,-276 449.942,-316.127 437.16,-340.213 420,-386 402.98,-431.412 359.673,-468.004 327.273,-490.251"/>
<polygon fill="black" stroke="black" points="325.241,-487.399 318.875,-495.868 329.133,-493.218 325.241,-487.399"/>
</g>
<!-- posthook -->
<g id="node17" class="node"><title>posthook</title>
<polygon fill="lightgrey" stroke="black" points="411.25,-166 140.75,-166 140.75,-128 411.25,-128 411.25,-166"/>
<text text-anchor="middle" x="276" y="-150.8" font-family="FangSong" font-size="14.00">执行后钩子</text>
<text text-anchor="middle" x="276" y="-135.8" font-family="FangSong" font-size="14.00">配置文件中hive.exec.post.hooks配置</text>
</g>
<!-- addchildtask&#45;&gt;posthook -->
<g id="edge13" class="edge"><title>addchildtask&#45;&gt;posthook</title>
<path fill="none" stroke="black" d="M276,-201.831C276,-194.131 276,-184.974 276,-176.417"/>
<polygon fill="black" stroke="black" points="279.5,-176.413 276,-166.413 272.5,-176.413 279.5,-176.413"/>
</g>
<!-- postdriverrun -->
<g id="node18" class="node"><title>postdriverrun</title>
<polygon fill="lightgrey" stroke="black" points="501.25,-54 50.75,-54 50.75,-16 501.25,-16 501.25,-54"/>
<text text-anchor="middle" x="276" y="-38.8" font-family="FangSong" font-size="14.00"> 任务执行时的钩子中的执行后方法 </text>
<text text-anchor="middle" x="276" y="-23.8" font-family="FangSong" font-size="14.00"> hive.exec.driver.run.hooks 配置的hook的postDriverRun方法 </text>
</g>
<!-- posthook&#45;&gt;postdriverrun -->
<g id="edge18" class="edge"><title>posthook&#45;&gt;postdriverrun</title>
<path fill="none" stroke="black" d="M276,-120.057C276,-103.3 276,-81.4941 276,-64.2917"/>
<polygon fill="black" stroke="black" points="279.5,-64.1912 276,-54.1912 272.5,-64.1913 279.5,-64.1912"/>
</g>
</g>
</svg>
